openapi: 3.0.0
info:
  title: API de Livros Simples
  description: API para reservar livros.
  version: 1.0.0
servers:
  - url: https://simple-books-api.click
    description: Servidor de Produção

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

security:
  - {}

paths:
  # --- STATUS ---
  /status:
    get:
      summary: Retorna o status da API
      responses:
        '200':
          description: OK

  # --- LIVROS ---
  /books:
    get:
      summary: Retorna uma lista de livros
      parameters:
        - in: query
          name: type
          schema:
            type: string
            enum: [fiction, non-fiction]
          description: Filtrar por tipo (ficção ou não ficção)
        - in: query
          name: limit
          schema:
            type: integer
            minimum: 1
            maximum: 20
          description: Limitar resultados (número entre 1 e 20)
      responses:
        '200':
          description: Uma lista de livros

  /books/{bookId}:
    get:
      summary: Recupera informações detalhadas sobre um livro
      parameters:
        - in: path
          name: bookId
          schema:
            type: integer
          required: true
          description: O ID do livro
      responses:
        '200':
          description: Detalhes do livro

  # --- AUTENTICAÇÃO ---
  /api-clients/:
    post:
      summary: Registrar cliente da API
      description: Registrar para obter um token de acesso.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                clientName:
                  type: string
                  example: Postman
                clientEmail:
                  type: string
                  example: valentin@example.com
              required:
                - clientName
                - clientEmail
      responses:
        '201':
          description: Criado
          content:
            application/json:
              schema:
                type: object
                properties:
                  accessToken:
                    type: string
        '409':
          description: Cliente da API já registrado

  # --- PEDIDOS (AUTENTICAÇÃO NECESSÁRIA) ---
  /orders:
    post:
      summary: Enviar um novo pedido
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                bookId:
                  type: integer
                customerName:
                  type: string
              required:
                - bookId
                - customerName
            example:
              bookId: 1
              customerName: João
      responses:
        '201':
          description: Pedido criado
          content:
            application/json:
              schema:
                type: object
                properties:
                  orderId:
                    type: string
                  created:
                    type: boolean

    get:
      summary: Visualizar todos os pedidos
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Lista de pedidos

  /orders/{orderId}:
    get:
      summary: Visualizar um pedido existente
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: orderId
          schema:
            type: string
          required: true
      responses:
        '200':
          description: Detalhes do pedido

    patch:
      summary: Atualizar um pedido existente
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: orderId
          schema:
            type: string
          required: true
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                customerName:
                  type: string
              required:
                - customerName
            example:
              customerName: João
      responses:
        '204':
          description: Pedido atualizado

    delete:
      summary: Excluir um pedido existente
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: orderId
          schema:
            type: string
          required: true
      responses:
        '204':
          description: Pedido excluído